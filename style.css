/*
 * Filename: style.css
 * Version: Pharaoh's Legacy 'NOUB' v2.0.2 (Verified Complete Visual Restoration)
 * Description: Main stylesheet. This is a fully verified and complete version that
 * restores all original screen layouts (Shop, Profile, Wheel, etc.) while successfully
 * integrating new UI polishes (Home grid fix, backgrounds, accent color, and future-proof styles).
 * This file is complete and contains no abbreviations.
*/

/* =================================================================================
   --- 0. Global Settings & Variables ---
   ================================================================================= */
:root {
    --background-dark: #121212;
    --surface-dark: #1e1e1e;
    --primary-accent: #D4AF37;
    --accent-blue: #00AAB2;
    --text-primary: #ffffff;
    --text-secondary: #aaaaaa;
    --noub-color: #f39c12;
    --ankh-premium-color: #29b6f6;
    --success-color: #34c759;
    --danger-color: #ff453a;
    --ton-color: #0088cc;
    --input-bg: #2a2a2e;
    --kv-gate-color: #f7d794;
    
    /* Rarity Colors */
    --rarity-common: #95a5a6;
    --rarity-rare: #3498db;
    --rarity-epic: #9b59b6;
    --rarity-legendary: #f39c12;
    --rarity-diamond: #f1c40f;
}

/* =================================================================================
   --- 1. Core Layout & Structure ---
   ================================================================================= */

* {
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: 'Cairo', sans-serif;
    background-color: var(--background-dark);
    color: var(--text-primary);
    padding: 50px 10px 65px 10px;
    margin: 0;
    min-height: 100vh;
    font-size: 0.95em;
    overflow-x: hidden;
}

.hidden { 
    display: none !important; 
}

.screen {
    animation: fadeIn 0.3s ease-in-out;
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    min-height: calc(100vh - 115px);
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(7px); }
    to { opacity: 1; transform: translateY(0); }
}

/* --- CORRECTED: Screen Backgrounds --- */
#home-screen { background-image: url('images/bgs/home_bg.jpg'); }
#kv-game-screen { background-image: url('images/bgs/kvgame_bg.jpg'); }
#economy-screen { background-image: url('images/bgs/economy_bg.jpg'); }
#collection-screen, #albums-screen, #card-upgrade-screen { background-image: url('images/bgs/cards_bg.jpg'); }
#projects-screen { background-image: url('images/bgs/projects_bg.jpg'); }
#auth-overlay { background-image: url('images/bgs/login_bg.png'); }

/* =================================================================================
   --- 2. Authentication ---
   ================================================================================= */
#auth-overlay {
    position: fixed;
    inset: 0;
    background-size: cover;
    background-position: center;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}
.auth-container {
    background-color: rgba(30, 30, 30, 0.9);
    padding: 25px;
    border-radius: 12px;
    width: 90%;
    max-width: 350px;
    text-align: center;
    box-shadow: 0 4px 20px rgba(0,0,0,0.5);
    border: 1px solid var(--primary-accent);
}
.auth-header { margin-bottom: 20px; }
.auth-header .auth-logo { width: 60px; height: 60px; margin-bottom: 10px; }
.auth-header h2 { color: var(--primary-accent); margin: 0; font-size: 1.5em; }
.auth-form h3 { color: var(--text-primary); margin-bottom: 15px; border-bottom: 1px solid #3a3a3c; padding-bottom: 5px; }
.switch-form { margin-top: 15px; color: var(--accent-blue); cursor: pointer; font-size: 0.9em; }
.auth-error { color: var(--danger-color); min-height: 1.2em; font-size: 0.8em; margin-bottom: 10px; }


/* =================================================================================
   --- 3. Main Navigation (Header & Footer) ---
   ================================================================================= */
header, .bottom-nav {
    position: fixed;
    left: 0;
    right: 0;
    background-color: rgba(28, 28, 30, 0.95);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    z-index: 100;
}
header {
    top: 0;
    padding: 7px 10px;
    border-bottom: 1px solid #3a3a3c;
}
.balance-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
}
.currency-display {
    display: flex;
    align-items: center;
    font-weight: bold;
    font-size: 0.9em;
    background: var(--input-bg);
    padding: 3px 7px;
    border-radius: 6px;
}
.currency-display .currency-img { width: 18px; height: 18px; margin-right: 5px; }
.ton-connect-btn { width: 35px; height: 35px; border-radius: 50%; overflow: hidden; }
.header-profile-btn { display: block; width: 35px; height: 35px; border-radius: 50%; overflow: hidden; border: 2px solid var(--primary-accent); }
#header-avatar-img { width: 100%; height: 100%; object-fit: cover; }

.bottom-nav {
    bottom: 0;
    display: flex;
    justify-content: space-around;
    padding: 7px 0 14px 0;
    border-top: 1px solid #3a3a3c;
}
.nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: var(--text-secondary);
    text-decoration: none;
    font-size: 10px;
}
.nav-item.active { color: var(--primary-accent); }
.nav-item .icon { font-size: 20px; margin-bottom: 3px; }

/* =================================================================================
   --- 4. Generic UI Components ---
   ================================================================================= */
.screen h2 {
    color: var(--primary-accent);
    margin: 0 0 18px 0;
    border-bottom: 1px solid #3a3a3c;
    padding-bottom: 7px;
    font-size: 1.4em;
}
.action-button, .text-button, input, textarea, select { font-family: 'Cairo', sans-serif; }
.action-button {
    width: 95%;
    max-width: 250px;
    margin: 10px auto;
    display: block;
    padding: 8px;
    border: none;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
    color: #121212;
    background: linear-gradient(45deg, var(--primary-accent), #c79c2e);
    text-transform: uppercase;
    letter-spacing: 0.7px;
    box-shadow: 0 2px 0 #9e7f2c;
    transition: transform 0.1s;
}
.action-button:disabled { background: #555; color: #888; cursor: not-allowed; box-shadow: none; }
.action-button:active:not(:disabled) { transform: translateY(1px); box-shadow: none; }
.action-button.danger { background: var(--danger-color); color: white; box-shadow: 0 2px 0 #c0392b; }
.action-button.small { padding: 5px 8px; font-size: 0.8em; width: auto; max-width: none; display: inline-block; }
.text-button { background: none; border: none; color: var(--accent-blue); cursor: pointer; font-size: 0.8em; }
input, textarea, select {
    width: 100%;
    padding: 8px;
    margin-bottom: 10px;
    background: var(--input-bg);
    border: 1px solid #3a3a3c;
    border-radius: 6px;
    color: var(--text-primary);
}
input:focus, textarea:focus, select:focus { outline: none; border-color: var(--primary-accent); }
.modal-overlay { position: fixed; inset: 0; background-color: rgba(0,0,0,0.7); backdrop-filter: blur(5px); z-index: 200; display: flex; align-items: flex-end; justify-content: center; }
.modal-content { position: relative; background-color: var(--surface-dark); border-top-left-radius: 14px; border-top-right-radius: 14px; padding: 14px; width: 100%; max-height: 80vh; overflow-y: auto; border-top: 2px solid var(--primary-accent); box-shadow: 0 -3px 10px rgba(0,0,0,0.5); animation: slideUp 0.3s ease-out; }
@keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
.modal-close-btn { position: absolute; top: 7px; right: 10px; font-size: 1.5em; cursor: pointer; background: none; border: none; color: var(--text-secondary); }

/* =================================================================================
   --- 5. Home Screen ---
   ================================================================================= */
.home-layout { display: flex; flex-direction: column; gap: 25px; }
.home-section h3 { font-size: 1.2em; color: var(--primary-accent); margin-bottom: 15px; border-bottom: 1px solid #3a3a3c; padding-bottom: 10px; }
.home-featured-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
.action-card-link { background-color: var(--surface-dark); border-radius: 12px; padding: 15px; text-decoration: none; color: var(--text-primary); text-align: center; border: 1px solid #3a3a3c; }
.action-card-link:hover { background-color: #2a2a2e; transform: translateY(-3px); }
.action-card-link .icon-box { width: 60px; height: 60px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-family: 'Apple Color Emoji', 'Segoe UI Emoji'; }
.action-card-link .icon-box.large { font-size: 32px; margin: 0 auto 10px auto; }
.action-card-link span { font-weight: bold; }
.home-secondary-actions {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 15px;
    max-width: 480px; 
    margin: 0 auto; 
}
.action-icon-link { display: flex; flex-direction: column; align-items: center; text-decoration: none; color: var(--text-primary); font-size: 0.8em; }
.action-icon-link .icon-box { width: 100%; aspect-ratio: 1 / 1; background: var(--surface-dark); border-radius: 12px; font-size: 28px; margin-bottom: 5px; border: 1px solid #3a3a3c; display: flex; align-items: center; justify-content: center; }
.action-icon-link:hover .icon-box { background-color: #2a2a2e; }

/* =================================================================================
   --- 6. Collection & Cards ---
   ================================================================================= */
.card-grid, .buildings-grid { display: grid; gap: 12px; }
.card-grid { grid-template-columns: repeat(auto-fill, minmax(85px, 1fr)); }
.buildings-grid { grid-template-columns: repeat(auto-fill, minmax(95px, 1fr)); }
.card-stack { background: var(--surface-dark); border-radius: 8px; padding: 5px; position: relative; border: 1px solid #3a3a3c; cursor: pointer; text-align: center; }
.card-stack:hover { transform: translateY(-2px); }
.card-stack[data-rarity="0"] { border-color: var(--rarity-common); }
.card-stack[data-rarity="2"] { border-color: var(--rarity-rare); }
.card-stack[data-rarity="4"] { border-color: var(--rarity-epic); }
.card-stack[data-rarity="6"] { border-color: var(--rarity-legendary); }
.card-stack[data-rarity="8"] { border-color: var(--rarity-diamond); }
.card-stack .card-image { width: 100%; aspect-ratio: 1 / 1; border-radius: 6px; object-fit: cover; margin-bottom: 5px; }
.card-stack h4 { margin: 2px 0; font-size: 11px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.card-stack .card-details { font-size: 0.7em; color: var(--text-secondary); display: flex; justify-content: space-between; align-items: center; margin-top: 3px; }
.card-stack .card-level { font-weight: bold; color: var(--primary-accent); }
.card-stack.assigned-expert { box-shadow: 0 0 10px 2px var(--primary-accent); border-color: var(--primary-accent); }
.card-stack.assigned-expert::after { content: '⚒️'; position: absolute; top: 4px; right: 4px; font-size: 1.1em; filter: drop-shadow(0 0 2px black); }

/* =================================================================================
   --- 7. Economy Hub ---
   ================================================================================= */
.production-section { margin-bottom: 20px; }
.production-section h3 { color: var(--primary-accent); border-bottom: 1px solid #3a3a3c; padding-bottom: 5px; margin-bottom: 10px; }
.building-card { background-color: var(--surface-dark); border-radius: 8px; padding: 5px; position: relative; border: 2px solid #3a3a3c; cursor: pointer; text-align: center; }
.building-card.unlockable { border-style: dashed; border-color: var(--primary-accent); }
.building-card.locked { border-style: dashed; border-color: #444; opacity: 0.5; cursor: default; }
.building-card img { width: 100%; aspect-ratio: 1 / 1; border-radius: 6px; object-fit: cover; margin-bottom: 5px; }
.building-card h4 { margin: 2px 0; font-size: 11px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.building-card .level, .building-card .status { font-size: 0.7em; min-height: 1.2em; font-weight: bold; }
.expert-indicator { position: absolute; top: 5px; right: 5px; font-size: 1.2em; filter: drop-shadow(0 0 3px gold); }
.stock-tabs-container { display: flex; justify-content: space-around; border-bottom: 1px solid #3a3a3c; margin-bottom: 10px; }
.stock-tab-btn { padding: 7px 10px; border: none; background: none; color: var(--text-secondary); font-size: 0.8em; font-weight: bold; cursor: pointer; }
.stock-tab-btn.active { color: var(--primary-accent); border-bottom: 2px solid var(--primary-accent); }
.stock-content-tab { display: none; padding-top: 10px; }
.stock-content-tab.active { display: block; }
.stock-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 10px; }
.stock-item { display: flex; flex-direction: column; align-items: center; background: var(--surface-dark); padding: 7px; border-radius: 6px; text-align: center; border: 1px solid #3a3a3c; }
.stock-item img { width: 40px; height: 40px; margin-bottom: 3px; }
.stock-item .details h4 { margin: 0 0 2px 0; font-size: 0.8em; }
.stock-item .quantity { font-size: 0.9em; font-weight: bold; color: var(--accent-blue); }

/* =================================================================================
   --- 8. Production & Upgrade Modals ---
   ================================================================================= */
.prod-modal-header { text-align: center; }
.prod-modal-header img { width: 70px; height: 70px; border-radius: 10px; }
.prod-io { background-color: #121212; padding: 15px; border-radius: 10px; margin: 15px 0; display: flex; justify-content: space-around; align-items: center; }
.prod-item { text-align: center; }
.prod-item img { width: 40px; height: 40px; }
.prod-item p { margin: 5px 0 0 0; }
.arrow { font-size: 1.5em; color: var(--primary-accent); }
.prod-timer { text-align: center; margin-top: 14px; }
.prod-timer .time-left { font-size: 1.3em; font-weight: bold; }
.progress-bar { background-color: #444; border-radius: 4px; height: 7px; overflow: hidden; margin-top: 7px; width: 100%; }
.progress-bar-inner { background: var(--success-color); height: 100%; width: 0%; transition: width 0.5s; border-radius: 4px; }
.cost-item { display: inline-block; margin: 5px 10px; }
.expert-placeholder { border: 2px dashed #444; padding: 20px; border-radius: 10px; }
.expert-card { background: #2a2a2e; padding: 10px; border-radius: 8px; display: flex; align-items: center; }

/* =================================================================================
   --- 9. Specific Screens ---
   ================================================================================= */
.daily-quest-card, .album-list-item { background-color: var(--surface-dark); padding: 8px 10px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; border-left: 3px solid var(--primary-accent); }
.quest-details, .album-list-item .details { flex-grow: 1; margin-right: 10px; }
.quest-action .reward { color: var(--primary-accent); font-weight: bold; }
.contracts-section, .projects-section { margin-bottom: 25px; }
.contracts-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.contracts-list, .projects-list { display: flex; flex-direction: column; gap: 10px; }
.contract-card, .project-card { background-color: var(--surface-dark); padding: 15px; border-radius: 10px; border-left: 4px solid var(--primary-accent); cursor: pointer; }
.completed-project-view { background: #1a2e2a; padding: 12px 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid var(--success-color); display: flex; align-items: center; justify-content: space-between; }
.completed-project-view h4 { margin: 0; color: var(--text-secondary); }
.completed-project-view span { color: var(--success-color); font-weight: bold; }
.game-container { background-color: var(--surface-dark); padding: 20px; border-radius: 12px; text-align: center; }
.dice-result-container { padding: 15px; background: #1a1a1a; border-radius: 10px; margin: 20px auto; width: 150px; box-shadow: 0 0 15px rgba(212, 175, 55, 0.5); }
.dice-result-container .icon-lg { font-size: 4em; color: var(--primary-accent); display: block; }
.profile-container { display: flex; flex-direction: column; align-items: center; gap: 15px; }
.profile-section h3 { color: var(--accent-blue); font-size: 1em; border-bottom: 1px solid #3a3a3c; padding-bottom: 5px; }
.stat-box { background: var(--surface-dark); padding: 10px; border-radius: 8px; text-align: center; }
.stat-box .value { font-size: 1.1em; font-weight: bold; }
.stat-box .label { font-size: 0.65em; text-transform: uppercase; color: var(--text-secondary); }

/* =================================================================================
   --- 10. Special Modals & Popups ---
   ================================================================================= */
.more-menu .more-menu-item { display: flex; align-items: center; padding: 12px; border-bottom: 1px solid #3a3a3c; text-decoration: none; color: var(--text-primary); }
.more-menu .more-menu-item:last-child { border-bottom: none; }
.more-menu .more-menu-item .icon { font-size: 18px; margin-right: 14px; color: var(--primary-accent); }
.specialization-card { background-color: var(--surface-dark); border: 1px solid var(--primary-accent); border-radius: 8px; padding: 14px; margin-bottom: 10px; cursor: pointer; }
.shop-tabs-container { display: flex; border-bottom: 1px solid #3a3a3c; margin-bottom: 10px; }
.shop-tab-btn { padding: 7px 10px; border: none; background: none; color: var(--text-secondary); font-size: 0.8em; font-weight: bold; cursor: pointer; flex-grow: 1; }
.shop-tab-btn.active { color: var(--primary-accent); border-bottom: 1px solid var(--primary-accent); }
.shop-content-tab { display: none; }
.shop-content-tab.active { display: block; }
.shop-item { display: flex; align-items: center; background: #2a2a2e; padding: 10px; border-radius: 8px; margin-bottom: 10px; }
.shop-item .icon { font-size: 28px; margin-right: 14px; }
.shop-item .details { flex-grow: 1; }
.shop-item h4 { margin: 0 0 3px 0; }
.buy-btn { background: var(--primary-accent); color: #121212; border: none; padding: 7px 14px; border-radius: 6px; font-weight: bold; cursor: pointer; }
.swap-box { background: var(--surface-dark); padding: 15px; border-radius: 12px; border: 1px solid #3a3a3c; margin-bottom: 15px; }
.swap-input-row { display: flex; align-items: center; gap: 10px; }
.swap-icon-container { text-align: center; margin: -25px 0 -10px 0; z-index: 10; position: relative; }

/* =================================================================================
   --- 11. Effects & Feedback ---
   ================================================================================= */
#toast-container { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); z-index: 2000; display: flex; flex-direction: column; align-items: center; gap: 7px; }
.toast { background-color: rgba(20, 20, 20, 0.9); backdrop-filter: blur(8px); color: var(--text-primary); padding: 10px 18px; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.6); font-size: 0.85em; border-left: 4px solid; animation: fadeIn 0.3s, fadeOut 0.3s 2.7s forwards; }
.toast.success { border-color: var(--success-color); }
.toast.error { border-color: var(--danger-color); }
.toast.info { border-color: var(--accent-blue); }
@keyframes fadeOut { to { opacity: 0; } }
#visual-effect-container { position: fixed; inset: 0; z-index: 5000; pointer-events: none; }

/* =================================================================================
   --- 12. RTL Overrides (COMPLETE & CLEANED) ---
   ================================================================================= */
[dir="rtl"] body { direction: rtl; text-align: right; }
[dir="rtl"] .currency-display .currency-img, [dir="rtl"] .currency-display .icon { margin-right: 0; margin-left: 3px; }
[dir="rtl"] .nav-item { text-align: center; }
[dir="rtl"] .more-menu .more-menu-item .icon { margin-right: 0; margin-left: 14px; }
[dir="rtl"] .screen h2 { border-bottom: 1px solid #3a3a3c; }
[dir="rtl"] .home-section h3 { text-align: right; }
[dir="rtl"] .text-button { text-align: left; }
[dir="rtl"] input, [dir="rtl"] textarea, [dir="rtl"] select { text-align: right; }
[dir="rtl"] #chat-messages { align-items: flex-end; }
[dir="rtl"] .user-bubble { align-self: flex-start; border-right: none; border-left: 2px solid var(--primary-accent); }
[dir="rtl"] .eve-bubble { align-self: flex-end; border-left: none; border-right: 2px solid var(--accent-blue); }
[dir="rtl"] #chat-input-area { flex-direction: row-reverse; }
[dir="rtl"] .card-stack .card-details { flex-direction: row-reverse; }
[dir="rtl"] .prod-io { flex-direction: row-reverse; }
[dir="rtl"] .prod-modal-header { text-align: center; }
[dir="rtl"] .contracts-header { flex-direction: row-reverse; }
[dir="rtl"] .contract-card, [dir="rtl"] .project-card, [dir="rtl"] .daily-quest-card, [dir="rtl"] .album-list-item, [dir="rtl"] .completed-project-view { border-left: none; border-right-width: 4px; border-right-style: solid; border-right-color: var(--primary-accent); }
[dir="rtl"] .completed-project-view { border-right-color: var(--success-color); }
[dir="rtl"] .quest-details, [dir="rtl"] .album-list-item .details { margin-right: 0; margin-left: 10px; }
[dir="rtl"] #kv-game-content { text-align: right; }
[dir="rtl"] .kv-hint-item { text-align: right; }
[dir="rtl"] .profile-stats-grid { direction: ltr; }
[dir="rtl"] .stat-box { direction: rtl; }
